import{r as d,a as T,o as _e,$ as ye,j as R,V,T as te,c as K,m as Ee}from"./index-DDvn9Y29.js";import{I as q,a as re,z as oe,U as ae,y as B,l as xe,T as Re,o as L,j as $e,H as X,s as le,n as ne,$ as ie,b as se,D as ue,u as Se,c as Ne,G as Fe,K as Ie,w as we,d as Oe,e as ke,f as D,p as Pe,r as de}from"./FilmDetailsPage-BpNOmPVU.js";import"./FilmsList-BRf3PW5p.js";import"./FilmImage-DDVeXnI1.js";function Te(e,t){return e!==null&&t!==null&&typeof e=="object"&&typeof t=="object"&&"id"in e&&"id"in t?e.id===t.id:e===t}function Ae(e=Te){return d.useCallback((t,o)=>{if(typeof e=="string"){let a=e;return(t==null?void 0:t[a])===(o==null?void 0:o[a])}return e(t,o)},[e])}let Me=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(e=>`${e}:not([tabindex='-1'])`).join(","),De=["[data-autofocus]"].map(e=>`${e}:not([tabindex='-1'])`).join(",");var G=(e=>(e[e.First=1]="First",e[e.Previous=2]="Previous",e[e.Next=4]="Next",e[e.Last=8]="Last",e[e.WrapAround=16]="WrapAround",e[e.NoScroll=32]="NoScroll",e[e.AutoFocus=64]="AutoFocus",e))(G||{}),W=(e=>(e[e.Error=0]="Error",e[e.Overflow=1]="Overflow",e[e.Success=2]="Success",e[e.Underflow=3]="Underflow",e))(W||{}),Ce=(e=>(e[e.Previous=-1]="Previous",e[e.Next=1]="Next",e))(Ce||{});function je(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(Me)).sort((t,o)=>Math.sign((t.tabIndex||Number.MAX_SAFE_INTEGER)-(o.tabIndex||Number.MAX_SAFE_INTEGER)))}function Ge(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(De)).sort((t,o)=>Math.sign((t.tabIndex||Number.MAX_SAFE_INTEGER)-(o.tabIndex||Number.MAX_SAFE_INTEGER)))}var Le=(e=>(e[e.Strict=0]="Strict",e[e.Loose=1]="Loose",e))(Le||{}),He=(e=>(e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e))(He||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",e=>{e.metaKey||e.altKey||e.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",e=>{e.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:e.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));let Ue=["textarea","input"].join(",");function Ke(e){var t,o;return(o=(t=e==null?void 0:e.matches)==null?void 0:t.call(e,Ue))!=null?o:!1}function ce(e,t=o=>o){return e.slice().sort((o,a)=>{let l=t(o),u=t(a);if(l===null||u===null)return 0;let r=l.compareDocumentPosition(u);return r&Node.DOCUMENT_POSITION_FOLLOWING?-1:r&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function ee(e,t,{sorted:o=!0,relativeTo:a=null,skipElements:l=[]}={}){let u=Array.isArray(e)?e.length>0?e[0].ownerDocument:document:e.ownerDocument,r=Array.isArray(e)?o?ce(e):e:t&64?Ge(e):je(e);l.length>0&&r.length>1&&(r=r.filter(s=>!l.some(v=>v!=null&&"current"in v?(v==null?void 0:v.current)===s:v===s))),a=a??u.activeElement;let i=(()=>{if(t&5)return 1;if(t&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),n=(()=>{if(t&1)return 0;if(t&2)return Math.max(0,r.indexOf(a))-1;if(t&4)return Math.max(0,r.indexOf(a))+1;if(t&8)return r.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),h=t&32?{preventScroll:!0}:{},c=0,p=r.length,g;do{if(c>=p||c+p<=0)return 0;let s=n+c;if(t&16)s=(s+p)%p;else{if(s<0)return 3;if(s>=p)return 1}g=r[s],g==null||g.focus(h),c+=i}while(g!==u.activeElement);return t&6&&Ke(g)&&g.select(),2}var Ve=(e=>(e[e.RegisterOption=0]="RegisterOption",e[e.UnregisterOption=1]="UnregisterOption",e))(Ve||{});let We={0(e,t){let o=[...e.options,{id:t.id,element:t.element,propsRef:t.propsRef}];return{...e,options:ce(o,a=>a.element.current)}},1(e,t){let o=e.options.slice(),a=e.options.findIndex(l=>l.id===t.id);return a===-1?e:(o.splice(a,1),{...e,options:o})}},z=d.createContext(null);z.displayName="RadioGroupDataContext";function Q(e){let t=d.useContext(z);if(t===null){let o=new Error(`<${e} /> is missing a parent <RadioGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(o,Q),o}return t}let J=d.createContext(null);J.displayName="RadioGroupActionsContext";function Y(e){let t=d.useContext(J);if(t===null){let o=new Error(`<${e} /> is missing a parent <RadioGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(o,Y),o}return t}function qe(e,t){return Oe(t.type,We,e,t)}let Be="div";function Xe(e,t){let o=d.useId(),a=re(),{id:l=`headlessui-radiogroup-${o}`,value:u,form:r,name:i,onChange:n,by:h,disabled:c=a||!1,defaultValue:p,...g}=e,s=Ae(h),[v,S]=d.useReducer(qe,{options:[]}),b=v.options,[$,I]=oe(),[N,_]=ae(),y=d.useRef(null),w=B(y,t),O=xe(p),[m,A]=Re(u,n,O),M=d.useMemo(()=>b.find(f=>!f.propsRef.current.disabled),[b]),k=d.useMemo(()=>b.some(f=>s(f.propsRef.current.value,m)),[b,m]),E=L(f=>{var C;if(c||s(f,m))return!1;let F=(C=b.find(H=>s(H.propsRef.current.value,f)))==null?void 0:C.propsRef.current;return F!=null&&F.disabled?!1:(A==null||A(f),!0)}),me=L(f=>{let C=y.current;if(!C)return;let F=ke(C),H=b.filter(x=>x.propsRef.current.disabled===!1).map(x=>x.element.current);switch(f.key){case D.Enter:Pe(f.currentTarget);break;case D.ArrowLeft:case D.ArrowUp:if(f.preventDefault(),f.stopPropagation(),ee(H,G.Previous|G.WrapAround)===W.Success){let x=b.find(j=>j.element.current===(F==null?void 0:F.activeElement));x&&E(x.propsRef.current.value)}break;case D.ArrowRight:case D.ArrowDown:if(f.preventDefault(),f.stopPropagation(),ee(H,G.Next|G.WrapAround)===W.Success){let x=b.find(j=>j.element.current===(F==null?void 0:F.activeElement));x&&E(x.propsRef.current.value)}break;case D.Space:{f.preventDefault(),f.stopPropagation();let x=b.find(j=>j.element.current===(F==null?void 0:F.activeElement));x&&E(x.propsRef.current.value)}break}}),Z=L(f=>(S({type:0,...f}),()=>S({type:1,id:f.id}))),fe=d.useMemo(()=>({value:m,firstOption:M,containsCheckedOption:k,disabled:c,compare:s,...v}),[m,M,k,c,s,v]),ve=d.useMemo(()=>({registerOption:Z,change:E}),[Z,E]),he={ref:w,id:l,role:"radiogroup","aria-labelledby":$,"aria-describedby":N,onKeyDown:me},be=d.useMemo(()=>({value:m}),[m]),ge=d.useCallback(()=>{if(O!==void 0)return E(O)},[E,O]);return T.createElement(_,{name:"RadioGroup.Description"},T.createElement(I,{name:"RadioGroup.Label"},T.createElement(J.Provider,{value:ve},T.createElement(z.Provider,{value:fe},i!=null&&T.createElement($e,{disabled:c,data:{[i]:m||"on"},overrides:{type:"radio",checked:m!=null},form:r,onReset:ge}),X({ourProps:he,theirProps:g,slot:be,defaultTag:Be,name:"RadioGroup"})))))}let ze="div";function Qe(e,t){var o;let a=Q("RadioGroup.Option"),l=Y("RadioGroup.Option"),u=d.useId(),{id:r=`headlessui-radiogroup-option-${u}`,value:i,disabled:n=a.disabled||!1,autoFocus:h=!1,...c}=e,p=d.useRef(null),g=B(p,t),[s,v]=oe(),[S,b]=ae(),$=le({value:i,disabled:n});ne(()=>l.registerOption({id:r,element:p,propsRef:$}),[r,l,p,$]);let I=L(k=>{var E;if(de(k.currentTarget))return k.preventDefault();l.change(i)&&((E=p.current)==null||E.focus())}),N=((o=a.firstOption)==null?void 0:o.id)===r,{isFocusVisible:_,focusProps:y}=ie({autoFocus:h}),{isHovered:w,hoverProps:O}=se({isDisabled:n}),m=a.compare(a.value,i),A=ue({ref:g,id:r,role:"radio","aria-checked":m?"true":"false","aria-labelledby":s,"aria-describedby":S,"aria-disabled":n?!0:void 0,tabIndex:n?-1:m||!a.containsCheckedOption&&N?0:-1,onClick:n?void 0:I,autoFocus:h},y,O),M=d.useMemo(()=>({checked:m,disabled:n,active:_,hover:w,focus:_,autofocus:h}),[m,n,w,_,h]);return T.createElement(b,{name:"RadioGroup.Description"},T.createElement(v,{name:"RadioGroup.Label"},X({ourProps:A,theirProps:c,slot:M,defaultTag:ze,name:"RadioGroup.Option"})))}let Je="span";function Ye(e,t){var o;let a=Q("Radio"),l=Y("Radio"),u=d.useId(),r=Se(),i=re(),{id:n=r||`headlessui-radio-${u}`,value:h,disabled:c=a.disabled||i||!1,autoFocus:p=!1,...g}=e,s=d.useRef(null),v=B(s,t),S=Ne(),b=Fe(),$=le({value:h,disabled:c});ne(()=>l.registerOption({id:n,element:s,propsRef:$}),[n,l,s,$]);let I=L(k=>{var E;if(de(k.currentTarget))return k.preventDefault();l.change(h)&&((E=s.current)==null||E.focus())}),{isFocusVisible:N,focusProps:_}=ie({autoFocus:p}),{isHovered:y,hoverProps:w}=se({isDisabled:c}),O=((o=a.firstOption)==null?void 0:o.id)===n,m=a.compare(a.value,h),A=ue({ref:v,id:n,role:"radio","aria-checked":m?"true":"false","aria-labelledby":S,"aria-describedby":b,"aria-disabled":c?!0:void 0,tabIndex:c?-1:m||!a.containsCheckedOption&&O?0:-1,autoFocus:p,onClick:c?void 0:I},_,w),M=d.useMemo(()=>({checked:m,disabled:c,hover:y,focus:N,autofocus:p}),[m,c,y,N,p]);return X({ourProps:A,theirProps:g,slot:M,defaultTag:Je,name:"Radio"})}let Ze=q(Xe),et=q(Qe),pe=q(Ye),tt=Ie,rt=we,ot=Object.assign(Ze,{Option:et,Radio:pe,Label:tt,Description:rt});const at=e=>_e({queryKey:["getFilmScheduleByIdQuery",e],queryFn:async()=>(await ye.get(`/cinema/film/${e}/schedule`)).data}),lt="_radio_group_1iare_1",nt="_label_1iare_8",it="_radio_group_item_1iare_12",st="_radio_group_item_wrapper_1iare_22",ut="_tabs_1iare_26",dt="_checked_1iare_33",ct="_segmented_1iare_38",pt="_last_1iare_62",P={radio_group:lt,label:nt,radio_group_item:it,radio_group_item_wrapper:st,tabs:ut,checked:dt,segmented:ct,last:pt},U=e=>{const{className:t,value:o,onChange:a,variant:l="segmented",items:u,label:r,...i}=e;return R.jsxs(V,{gap:"16",children:[r&&R.jsx(te,{variant:"typography14_regular",className:P.label,children:r}),R.jsx(ot,{className:K(P.radio_group,{},[t,P[l]]),value:o,onChange:a,"aria-label":"Server size",...i,children:u==null?void 0:u.map((n,h)=>R.jsx(pe,{disabled:n.disabled,className:K(P.radio_group_item_wrapper,{},[t,P[l]]),value:n.value,children:()=>R.jsx("li",{className:K(P.radio_group_item,{[P.checked]:n.value===o,[P.last]:h===u.length-1}),children:n.content})},n.value))})]})},mt=(e,t)=>{const o=e==null?void 0:e.schedules.map(r=>({value:r.date,content:Ee(r.date,"ddd, DD MMM")})),a=[],l=[],u=[];if(e!=null&&e.schedules&&e.schedules.length>0){const r=e.schedules.find(i=>i.date===t);r&&r.seances&&r.seances.forEach(i=>{i.hall.name==="Red"?a.push({value:`${i.time} Red`,content:i.time}):i.hall.name==="Blue"?l.push({value:`${i.time} Blue`,content:i.time}):i.hall.name==="Purple"&&u.push({value:`${i.time} Purple`,content:i.time})})}return{dateItems:o,redHallItems:a,blueHallItems:l,violetHallItems:u}},ft=e=>{const{className:t,pageId:o,setSeanceDate:a,hall:l,setSeanceTime:u,seance:r,setHall:i}=e,{data:n}=at(o),{dateItems:h,blueHallItems:c,redHallItems:p,violetHallItems:g}=mt(n,r==null?void 0:r.date),s=d.useCallback(v=>{var I,N;u(v);const S=v.split(" ")[0],b=v.split(" ")[1],$=(I=n==null?void 0:n.schedules)==null?void 0:I.find(_=>{var y;return _.date===(r==null?void 0:r.date)&&((y=_.seances)==null?void 0:y.some(w=>w.time===S))});if($&&((N=$.seances)==null?void 0:N.length)>0){const _=$.seances.find(y=>y.time===S&&y.hall.name===b);_&&(l==null?void 0:l.name)!==b&&i(_.hall)}},[n==null?void 0:n.schedules,l==null?void 0:l.name,r==null?void 0:r.date,i,u]);return R.jsxs(V,{gap:"24",className:t,children:[R.jsx(te,{variant:"typography24_bold",children:"Расписание"}),R.jsxs(V,{gap:"32",children:[R.jsx(U,{variant:"segmented",value:r==null?void 0:r.date,onChange:a,items:h}),p.length>0&&R.jsx(U,{variant:"tabs",label:"Красный зал",value:r==null?void 0:r.timeWithHallName,onChange:s,items:p}),p.length>0&&R.jsx(U,{variant:"tabs",label:"Синий зал",value:r==null?void 0:r.timeWithHallName,onChange:s,items:c}),g.length>0&&R.jsx(U,{variant:"tabs",label:"Фиолетовый зал",value:r==null?void 0:r.timeWithHallName,onChange:s,items:g})]})]})},_t=d.memo(ft);export{_t as default};
