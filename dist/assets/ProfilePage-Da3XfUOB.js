import{q as j,$ as b,z as s,u as _,d as y,t as P,r as p,j as o,c as U,C as m,I as l,B as F,T as u,V as q}from"./index-DDvn9Y29.js";const E=()=>j({mutationKey:["updateProfile"],mutationFn:({phone:e,profile:i})=>b.patch("/users/profile",{phone:e,profile:i})}),N=s.object({firstname:s.string({required_error:"Поле обязательно для заполнения"}).min(2,{message:"Имя должно сдержать минимум 2 букву"}),lastname:s.string({required_error:"Поле обязательно для заполнения"}).min(1,{message:"Фамилия должно сдержать минимум 1 букву"}),middlename:s.string(),email:s.union([s.literal(""),s.string().email("Неверный формат почты")]),phone:s.string().optional()}),v=()=>{const{user:e}=_();return y({resolver:P(N),defaultValues:{middlename:(e==null?void 0:e.middlename)||"",firstname:(e==null?void 0:e.firstname)||"",lastname:(e==null?void 0:e.lastname)||"",email:(e==null?void 0:e.email)||"",phone:(e==null?void 0:e.phone)||""}})},w="_update_profile_form_rnwyx_1",M="_update_button_rnwyx_8",V="_error_message_rnwyx_12",c={update_profile_form:w,update_button:M,error_message:V},$=p.memo(e=>{const{className:i}=e,{user:n,setUserData:g}=_(),d=E(),t=v(),[f,x]=p.useState(""),h=async r=>{const a=await d.mutateAsync({profile:{middlename:r.middlename,firstname:r.firstname,lastname:r.lastname,email:r.email,city:n==null?void 0:n.city},phone:(n==null?void 0:n.phone)||""});if(!a.data.success&&a.data.reason)return x(a.data.reason);g({firstname:r.firstname,lastname:r.lastname,middlename:r.middlename,email:r.email,phone:(n==null?void 0:n.phone)||""})};return o.jsxs("form",{className:U(c.update_profile_form,{},[i]),onSubmit:t.handleSubmit(h),children:[o.jsx(m,{control:t.control,name:"firstname",render:({field:r,fieldState:a})=>o.jsx(l,{...r,label:"Имя",required:!0,...a.error&&{error:a.error.message}})}),o.jsx(m,{control:t.control,name:"lastname",render:({field:r,fieldState:a})=>o.jsx(l,{...r,label:"Фамилия",required:!0,...a.error&&{error:a.error.message}})}),o.jsx(m,{control:t.control,name:"middlename",render:({field:r,fieldState:a})=>o.jsx(l,{...r,label:"Отчество",...a.error&&{error:a.error.message}})}),o.jsx(m,{control:t.control,name:"phone",disabled:!0,render:({field:r,fieldState:a})=>o.jsx(l,{...r,label:"Номер",disabled:!0,...a.error&&{error:a.error.message}})}),o.jsx(m,{control:t.control,name:"email",render:({field:r,fieldState:a})=>o.jsx(l,{...r,label:"Email",...a.error&&{error:a.error.message}})}),o.jsx(F,{disabled:d.isPending,type:"submit",className:c.update_button,children:o.jsx(u,{variant:"typography16_regular",children:d.isPending?"Загрузка...":"Обновить данные"})}),f&&o.jsx(u,{className:c.error_message,variant:"typography16_regular",children:f})]})}),B=()=>o.jsxs(q,{gap:"32",children:[o.jsx(u,{tag:"h1",variant:"typography32_bold",children:"Профиль"}),o.jsx($,{})]}),D=p.memo(B);export{D as default};
